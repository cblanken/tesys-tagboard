{% extends 'account/base_entrance.html' %}

{% load i18n %}
{% load allauth account %}

{% block head_title %}
  {% trans 'Sign In' %}
{% endblock %}
{% block content %}
  {% include 'heading.html' with text=_('LOGIN') %}

  <div class="min-h-screen flex gap-4 justify-center">
    <form method="post" action="{% url 'account_login' %}" class="bg-base-300 h-full mt-3 flex flex-col gap-4 p-8 lg:w-1/2 rounded-box bg-base-300 sm:min-w-[450px] lg:max-w-[800px] max-w-3xl">
      {% csrf_token %}
      {% if form.errors %}
        <div class="text-error">{{ form.errors }}</div>
      {% endif %}
      <h2 class="text-4xl font-bold text-base-accent mb-6 text-center">Log In to your account</h2>

      <div class="mb-5">
        <label class="block text-sm font-medium mb-1">User name</label>
        <input required type="text" name="login" class="w-full text-primary-content px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all" placeholder="User name here" />
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Password</label>
        <input required type="password" name="password" class="w-full text-primary-content px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all" placeholder="••••••••" />
      </div>

      <div class="flex items-center justify-between">
        <label class="flex items-center">
          <input type="checkbox" class="rounded border-gray-300" />
          <span class="ml-2 text-sm" name="remember">Remember me</span>
        </label>
        <a href="{% url 'account_reset_password' %}" class="text-sm text-warning hover:text-primary">Forgot password?</a>
      </div>

      <button type="submit" class="w-full bg-primary hover:bg-primary/80 text-white font-medium py-2.5 rounded-lg transition-colors cursor-pointer">Log In</button>
      <div class="divider my-6">OR</div>

      <!-- Discord -->
      <a href="/accounts/discord/login/?process=login" class="btn text-white mx-auto" style="background-color: #5865F2; border-color: #5865F2;">
        <svg aria-label="Discord logo" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor">
          <path d="M13.545 2.907a13.2 13.2 0 0 0-3.257-1.011.05.05 0 0 0-.052.025c-.141.25-.297.577-.406.833a12.2 12.2 0 0 0-3.658 0 8 8 0 0 0-.412-.833.05.05 0 0 0-.052-.025c-1.125.194-2.22.534-3.257 1.011a.04.04 0 0 0-.021.018C.356 6.024-.213 9.047.066 12.032q.003.022.021.037a13.3 13.3 0 0 0 3.995 2.02.05.05 0 0 0 .056-.019q.463-.63.818-1.329a.05.05 0 0 0-.01-.059l-.018-.011a9 9 0 0 1-1.248-.595.05.05 0 0 1-.02-.066l.015-.019q.127-.095.248-.195a.05.05 0 0 1 .051-.007c2.619 1.196 5.454 1.196 8.041 0a.05.05 0 0 1 .053.007q.121.1.248.195a.05.05 0 0 1-.004.085 8 8 0 0 1-1.249.594.05.05 0 0 0-.03.03.05.05 0 0 0 .003.041c.24.465.515.909.817 1.329a.05.05 0 0 0 .056.019 13.2 13.2 0 0 0 4.001-2.02.05.05 0 0 0 .021-.037c.334-3.451-.559-6.449-2.366-9.106a.03.03 0 0 0-.02-.019m-8.198 7.307c-.789 0-1.438-.724-1.438-1.612s.637-1.613 1.438-1.613c.807 0 1.45.73 1.438 1.613 0 .888-.637 1.612-1.438 1.612m5.316 0c-.788 0-1.438-.724-1.438-1.612s.637-1.613 1.438-1.613c.807 0 1.451.73 1.438 1.613 0 .888-.631 1.612-1.438 1.612" />
        </svg>Discord
      </a>

      <p class="py-2 text-sm text-center">
        If you haven't created an account yet, then please <a href="{% url 'account_signup' %}">sign up</a> first.
      </p>
    </form>
  </div>

  {% comment %} <div class="m-auto md:max-w-xl xl:max-w-3xl">
    {% if not SOCIALACCOUNT_ONLY %}
      {% setvar link %}
      <a href="{{ signup_url }}">
        {% endsetvar %}
        {% setvar end_link %}
      </a>
      {% endsetvar %}
      <p class="py-2">
        {% blocktranslate %}If you haven't created an account yet, then please {{ link }}sign up{{ end_link }} first.{% endblocktranslate %}
      </p>
      {% url 'account_login' as login_url %}
      {% element form form=form method='post' action=login_url tags='entrance,login' %}
      {% slot body %}
      {% csrf_token %}
      {% element fields form=form unlabeled=True %}
      {% endelement %}
      {{ redirect_field }}
      {% endslot %}
      {% slot actions %}
      {% element button type='submit' tags='prominent,login' %}
      {% trans 'Sign In' %}
      {% endelement %}
      {% endslot %}
      {% endelement %}
    {% endif %}
    {% if LOGIN_BY_CODE_ENABLED or PASSKEY_LOGIN_ENABLED %}
      {% element hr %}
      {% endelement %}
      {% element button_group vertical=True %}
      {% if PASSKEY_LOGIN_ENABLED %}
        {% element button type='submit' form='mfa_login' id='passkey_login' tags='prominent,login,outline,primary' %}
        {% trans 'Sign in with a passkey' %}
        {% endelement %}
      {% endif %}
      {% if LOGIN_BY_CODE_ENABLED %}
        {% element button href=request_login_code_url tags='prominent,login,outline,primary' %}
        {% trans 'Send me a sign-in code' %}
        {% endelement %}
      {% endif %}
      {% endelement %}
    {% endif %}
    {% if SOCIALACCOUNT_ENABLED %}
      {% include 'socialaccount/snippets/login.html' with page_layout='entrance' %}
    {% endif %}
  </div> {% endcomment %}

{% endblock %}
{% block extra_body %}
  {{ block.super }}
  {% if PASSKEY_LOGIN_ENABLED %}
    {% include 'mfa/webauthn/snippets/login_script.html' with button_id='passkey_login' %}
  {% endif %}
{% endblock %}
